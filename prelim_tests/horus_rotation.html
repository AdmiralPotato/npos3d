<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="generator" content="Admiral's Hands">
<title></title>
<style>
*{
	margin: 0px;
	padding: 0px;
	border: 0px;
	outline: 0px;
}
html,body,#canvas{
height: 100%;
width: 100%;
}
body{
	background-color: #000;
}
#canvas{
	position: fixed;
}
#controls{
	position: absolute;
	top: 0px;
	left: 0px;
	padding: 16px;
	background-color: rgba(255,255,255,0.1);
	color: #9f0;
	font-size: 12px;
	line-height: 16px;
	font-family: monospace;
	white-space: pre-wrap;
}
</style>
</head>
<body><canvas id="canvas"></canvas>
<div id="controls">The following controls do things:
Move your mouse to rotate the model
Scroll to zoom in and out
</div>
<script>
//--------------------------------
//Basic scene setup
//--------------------------------

var canvas = document.getElementById('canvas');
var c = canvas.getContext('2d');
var w=0,h=0,cx=0,cy=0,wph=0;
var pi = Math.PI;
var tau = pi * 2;

//Field Of View; Important!
var fov = 550;
var clipNear = fov; //This line is also VERY important! Never have the clipNear less than the FOV!
var clipFar = -1000;

//Kind of a hack, but it works in a pinch.
var camera = [0,0,0];

//which is short for renderQueue - push ob3Ds into this to get them to show up in the scene
//invoke [ob].destroy(); to remove an ob3D from the scene.
var rQ = [];


//--------------------------------
//Basic input setup
//--------------------------------

var mpos = [0,0];
window.onmousemove = function(e){mpos=[e.clientX - cx, e.clientY - cy];}

var scroll=0;
window.onmousewheel = function(e){scroll=e.wheelDelta;}; //Chrome
window.addEventListener('DOMMouseScroll',function(e){scroll=e.detail;},false); //FireFox. Wut. You. Smokin.

var keyList = [];
keyList[32] = 'space';
keyList[38] = 'up';
keyList[40] = 'down';
keyList[37] = 'left';
keyList[39] = 'right';
keyList[49] = 'one';
keyList[50] = 'two';
keyList[51] = 'three';
keyList[52] = 'four';
var kb = {};
function setKey(e){
	if(e.type == 'keyup'){val = false;}
	else{val = true;}
	if(keyList[e.keyCode]){
		kb[keyList[e.keyCode]] = val;
	}
}
window.onkeydown = setKey;
window.onkeyup = setKey;


//--------------------------------
//This is where all of the 3D and math happens
//--------------------------------


var project3Dto2D = function(p3){
	var scale = fov/(fov + -p3[2]), p2 = {};
	p2.x = (p3[0] * scale);
	p2.y = (p3[1] * scale);
	p2.scale = scale;
	return p2;
};

var getP3Offset = function(p3,offset){
	//a quick hack to quickly add the offset of the object
	var p3 = [p3[0]+offset[0], p3[1]+offset[1], p3[2]+offset[2]];
	return p3;
}

var rotatePoint = function(x,y,rad){
	var length = Math.sqrt((x * x) + (y * y));
	var currentRad = Math.atan2(x,y);
	x = Math.sin(currentRad - rad) * length;
	y = Math.cos(currentRad - rad) * length;
	var output = [x,y];
	return output;
}

var getP3Rotated = function(p3,rot){
	var x = p3[0], y = p3[1], z = p3[2];
	var xr = rot[0], yr = rot[1], zr = rot[2];
	//x...
	var zy = rotatePoint(z,y,xr);
	z = zy[0];
	y = zy[1];
	//y...
	var xz = rotatePoint(x,z,yr);
	x = xz[0];
	z = xz[1];
	//z...
	var xy = rotatePoint(x,y,zr);
	x = xy[0];
	y = xy[1];
	return [x,y,z];
}

var drawLines = function(o){
	var computedPointList = [];
	for(var i = 0; i < o.shape.points.length; i += 1){
		//to make sure I'm not messing with the original array...
		var point = [o.shape.points[i][0],o.shape.points[i][1],o.shape.points[i][2]];
//ONLY FOR THE HORUS MODEL!!!!! MOVE BEFORE ROTATING!!!
		point = getP3Offset(point, o.pos);
		point = getP3Rotated(point, o.rot);
//		point = getP3Offset(point, o.pos);
		point = getP3Offset(point, camera);
		computedPointList[i] = point;
	}
	for(var i = 0; i < o.shape.lines.length; i += 1){
		//offset the points by the object's position
		var p3a = computedPointList[o.shape.lines[i][0]];
		var p3b = computedPointList[o.shape.lines[i][1]];
		//if the depths of the first and second point in the line are less than the far plane...
		if( p3a[2] < clipNear && p3b[2] < clipNear && p3a[2] > clipFar && p3b[2] > clipFar){
			var p0 = project3Dto2D(p3a);
			var p1 = project3Dto2D(p3b);
			//If the line is completely off screen, do not bother rendering it.
			if(((p0.x < cx && p0.x > -cx) || (p1.x < cx && p1.x > -cx)) && ((p0.y < cy && p0.y > -cy) || (p1.y < cy && p1.y > -cy))){
				c.beginPath();
				c.moveTo(p0.x,p0.y);
				c.lineTo(p1.x,p1.y);
				
				c.strokeStyle= o.shape.lines[i][2] || o.shape.color || '#fff';
				//c.lineWidth=2;
				c.lineCap='round';
				c.stroke();
			}
		}
	}
}

//The only reason this isn't with the rest of the shapes is because I need to use it inside the prototype of ob3D
var cubeShape = {
	color:'#999',
	points:[
		[ 10, 10, 10],
		[ 10, 10,-10],
		[ 10,-10, 10],
		[ 10,-10,-10],
		[-10, 10, 10],
		[-10, 10,-10],
		[-10,-10, 10],
		[-10,-10,-10]
	],
	lines:[
		[0,1],
		[2,3],
		[4,5],
		[6,7],
		[3,1],
		[2,0],
		[7,5],
		[6,4],
		[5,1],
		[7,3],
		[4,0],
		[6,2]
	],
};

var ob3D = function(pos,shape){
	if(this === window){throw 'JIM TYPE ERROR'};
	this.pos = pos || [0,0,0];
	this.rot = [0,0,0];
	if(shape){this.shape = shape;}
	return this;
}

ob3D.prototype = {
	shape: cubeShape,
	pos:[0,0,0],
	update:function(){
		drawLines(this);
	},
	destroy:function(){
		for(var i = 0; i < rQ.length; i += 1){
			if(rQ[i] === this){
				rQ.splice(i,1);
			}
		}
	}
};

var rint = function(num){
	return Math.round(((Math.random()*2)-1)*num);
}


//--------------------------------
//Some Meshes to play with!
//--------------------------------

var horus = {"color":"#f00","points":[[47.7315,-348.3326,13.502500000000001],[-47.7315,-348.3326,13.502500000000001],[39.179199999999994,-339.3796,26.7136],[-39.179199999999994,-339.3796,26.7136],[47.7315,-345.0571,42.9819],[-47.7315,-345.0571,42.9819],[53.19049999999999,-354.2285,35.9578],[-53.19049999999999,-354.2285,35.9578],[54.100300000000004,-354.66519999999997,21.8004],[-54.100300000000004,-354.66519999999997,21.8004],[64.2621,-367.1445,8.1762],[-64.2621,-367.1445,8.1762],[63.2066,-363.5668,52.23989999999999],[-63.2066,-363.5668,52.23989999999999],[24.02,-329.0614,68.1176],[-24.02,-329.0614,68.1176],[27.843600000000002,-336.0146,24.4615],[-27.843600000000002,-336.0146,24.4615],[43.736799999999995,-345.8758,-10.1176],[-43.736799999999995,-345.8758,-10.1176],[14.974599999999999,-318.1615,19.5399],[-14.974599999999999,-318.1615,19.5399],[0.2601,-299.01439999999997,3.9007],[-0.2601,-299.01439999999997,3.9007],[4.758500000000001,-290.4417,12.1232],[-4.758500000000001,-290.4417,12.1232],[12.6805,-298.7043,35.7287],[-12.6805,-298.7043,35.7287],[21.0682,-320.9396,76.7634],[-21.0682,-320.9396,76.7634],[9.7287,-290.5825,44.3745],[-9.7287,-290.5825,44.3745],[41.739599999999996,-347.40099999999995,83.8372],[-41.739599999999996,-347.40099999999995,83.8372],[38.7878,-339.2792,92.483],[-38.7878,-339.2792,92.483],[63.1405,-362.7595,98.4575],[-63.1405,-362.7595,98.4575],[63.1405,-364.7917,86.7706],[-63.1405,-364.7917,86.7706],[86.71990000000001,-394.921,79.4347],[-86.71990000000001,-394.921,79.4347],[86.71990000000001,-392.8888,91.1216],[-86.71990000000001,-392.8888,91.1216],[99.03359999999999,-413.7671,81.66879999999999],[-99.03359999999999,-413.7671,81.66879999999999],[99.03359999999999,-409.82219999999995,70.4817],[-99.03359999999999,-409.82219999999995,70.4817],[110.1523,-439.171,58.4639],[-110.1523,-439.171,58.4639],[105.38069999999999,-435.22610000000003,48.3455],[-105.38069999999999,-435.22610000000003,48.3455],[105.9332,-447.2837,13.175],[-105.9332,-447.2837,13.175],[115.62920000000001,-451.2286,18.7552],[-115.62920000000001,-451.2286,18.7552],[107.76740000000001,-445.1571,-12.9833],[-107.76740000000001,-445.1571,-12.9833],[96.6018,-441.2121,-12.2906],[-96.6018,-441.2121,-12.2906],[94.399,-426.0408,-54.7763],[-94.399,-426.0408,-54.7763],[67.1699,-415.81340000000006,-51.9826],[-67.1699,-415.81340000000006,-51.9826],[87.996,-415.3408,-78.7114],[-87.996,-415.3408,-78.7114],[57.48,-403.8788,-75.5804],[-57.48,-403.8788,-75.5804],[54.1749,-398.53459999999995,-88.7838],[-54.1749,-398.53459999999995,-88.7838],[84.6909,-409.9965,-91.9148],[-84.6909,-409.9965,-91.9148],[42.8927,-392.69059999999996,-108.6711],[-42.8927,-392.69059999999996,-108.6711],[73.40870000000001,-404.52329999999995,-109.7514],[-73.40870000000001,-404.52329999999995,-109.7514],[58.7395,-362.7595,122.3484],[-58.7395,-362.7595,122.3484],[82.3189,-392.8888,115.01259999999999],[-82.3189,-392.8888,115.01259999999999],[35.5115,-340.91040000000004,113.4485],[-35.5115,-340.91040000000004,113.4485],[20.197000000000003,-330.0459,102.50030000000001],[-20.197000000000003,-330.0459,102.50030000000001],[52.24529999999999,-364.47729999999996,140.5539],[-52.24529999999999,-364.47729999999996,140.5539],[27.481299999999997,-344.6977,129.1693],[-27.481299999999997,-344.6977,129.1693],[0,-383.365,156.3973],[-1.5785,-356.8434,144.687],[1.5785,-356.8434,144.687],[0,-400.26640000000003,160.8538],[60.185,-389.22159999999997,138.8134],[-60.185,-389.22159999999997,138.8134],[0,-445.1544,157.00730000000001],[60.185,-439.28580000000005,133.0631],[-60.185,-439.28580000000005,133.0631],[53.8393,-476.7917,111.03479999999999],[-53.8393,-476.7917,111.03479999999999],[0,-484.93820000000005,139.33089999999999],[0,-537.3871,102.464],[54.36729999999999,-514.3202,81.342],[-54.36729999999999,-514.3202,81.342],[0,-573.5641,39.706],[60.185,-549.857,30.420199999999998],[-60.185,-549.857,30.420199999999998],[0,-588.7393999999999,-11.4029],[60.185,-565.5423,-14.235700000000001],[-60.185,-565.5423,-14.235700000000001],[0,-584.1329,-72.9718],[60.185,-563.6011,-67.5463],[-60.185,-563.6011,-67.5463],[0,-564.6418,-118.91290000000001],[60.185,-545.4823,-103.3991],[-60.185,-545.4823,-103.3991],[0,-530.1492,-143.44570000000002],[59.3055,-524.8207,-116.425],[-59.3055,-524.8207,-116.425],[114.4507,-532.7239999999999,-24.1404],[-114.4507,-532.7239999999999,-24.1404],[114.8071,-533.2572,-77.4825],[-114.8071,-533.2572,-77.4825],[104.54319999999998,-517.902,19.704],[-104.54319999999998,-517.902,19.704],[81.9156,-495.8931,64.0724],[-81.9156,-495.8931,64.0724],[111.109,-485.06710000000004,19.704],[-111.109,-485.06710000000004,19.704],[127.5827,-491.8838,-24.1404],[-127.5827,-491.8838,-24.1404],[128.1754,-492.129,-77.4825],[-128.1754,-492.129,-77.4825],[82.8082,-431.95050000000003,93.8009],[-82.8082,-431.95050000000003,93.8009],[87.41839999999999,-467.8966,70.0429],[-87.41839999999999,-467.8966,70.0429],[94.399,-426.0408,-54.7763],[-94.399,-426.0408,-54.7763],[128.1754,-492.129,-77.4825],[-128.1754,-492.129,-77.4825],[114.8071,-533.2572,-77.4825],[-114.8071,-533.2572,-77.4825],[60.185,-563.6011,-67.5463],[-60.185,-563.6011,-67.5463],[90.6408,-525.4022,-100.5529],[-90.6408,-525.4022,-100.5529],[104.009,-484.274,-100.5529],[-104.009,-484.274,-100.5529],[90.6408,-525.4022,-100.5529],[-90.6408,-525.4022,-100.5529],[104.009,-484.274,-100.5529],[-104.009,-484.274,-100.5529],[76.3517,-520.1723000000001,-112.2906],[-76.3517,-520.1723000000001,-112.2906],[96.4444,-482.4006,-105.9805],[-96.4444,-482.4006,-105.9805],[0,-511.70739999999995,-153.2734],[53.5161,-506.37879999999996,-126.25269999999999],[-53.5161,-506.37879999999996,-126.25269999999999],[77.36800000000001,-467.5072,-116.82920000000001],[-77.36800000000001,-467.5072,-116.82920000000001],[54.6207,-503.4637,-124.5701],[-54.6207,-503.4637,-124.5701],[2.4495,-285.5272,13.3904],[-2.4495,-285.5272,13.3904],[13.832,-322.9492,116.54310000000001],[-13.832,-322.9492,116.54310000000001],[0,-321.9404,125.349],[10.1877,-309.71160000000003,89.1024],[-10.1877,-309.71160000000003,89.1024],[7.0678,-302.9196,92.7562],[-7.0678,-302.9196,92.7562],[0,-300.0438,96.0128],[21.4091,-327.088,22.000700000000002],[-21.4091,-327.088,22.000700000000002],[15.3984,-305.7611,60.568999999999996],[-15.3984,-305.7611,60.568999999999996],[18.3502,-313.8829,51.9232],[-18.3502,-313.8829,51.9232],[0,-286.9059,47.4691],[0,-282.6701,13.253400000000001],[0,-284.99850000000004,-5.2921000000000005],[7.0678,-293.661,75.2041],[-7.0678,-293.661,75.2041],[0,-290.3886,78.0619],[10.1877,-300.8681,72.4583],[-10.1877,-300.8681,72.4583]],"lines":[[0,8],[0,18],[0,2],[0,18],[1,19],[1,9],[1,3],[1,19],[2,16],[2,4],[2,16],[3,5],[3,17],[3,17],[4,6],[4,14],[4,14],[5,15],[5,15],[5,7],[6,12],[6,8],[6,12],[7,13],[7,9],[7,13],[8,10],[8,10],[9,11],[9,11],[10,12],[10,18],[11,13],[11,19],[12,14],[13,15],[14,28],[14,177],[14,16],[14,177],[14,28],[14,32],[14,16],[15,17],[15,178],[15,178],[15,29],[15,33],[15,29],[15,17],[16,173],[16,18],[17,19],[17,174],[20,26],[20,173],[20,26],[20,22],[21,174],[21,27],[21,23],[21,27],[22,181],[22,24],[22,24],[23,25],[23,25],[23,181],[24,181],[24,26],[24,26],[24,163],[24,181],[24,163],[25,27],[25,164],[25,27],[25,164],[25,181],[25,181],[26,30],[26,177],[26,177],[26,30],[27,31],[27,178],[27,31],[27,178],[28,175],[28,34],[28,34],[28,175],[28,82],[28,82],[29,35],[29,176],[29,35],[29,83],[29,83],[29,176],[30,179],[30,163],[30,163],[30,175],[31,176],[31,164],[31,179],[31,164],[32,34],[32,38],[32,34],[33,39],[33,35],[33,35],[34,36],[34,80],[34,80],[34,36],[35,81],[35,37],[35,81],[35,37],[36,76],[36,38],[36,42],[36,38],[36,42],[36,76],[37,39],[37,77],[37,77],[37,43],[37,43],[37,39],[38,40],[39,41],[40,46],[40,42],[40,42],[41,43],[41,43],[41,47],[42,44],[42,78],[42,44],[42,78],[43,79],[43,45],[43,45],[43,79],[44,48],[44,46],[44,48],[44,132],[44,132],[44,46],[45,49],[45,133],[45,49],[45,47],[45,133],[45,47],[46,50],[47,51],[48,54],[48,50],[48,134],[48,134],[48,50],[48,54],[49,135],[49,51],[49,135],[49,55],[49,55],[49,51],[50,52],[51,53],[52,58],[52,54],[52,54],[53,55],[53,55],[53,59],[54,126],[54,56],[54,56],[54,126],[55,57],[55,127],[55,127],[55,57],[56,60],[56,60],[56,58],[56,128],[56,58],[56,128],[57,59],[57,61],[57,59],[57,129],[57,61],[57,129],[58,62],[59,63],[60,138],[60,130],[60,136],[60,130],[60,62],[60,64],[60,62],[60,64],[61,131],[61,131],[61,65],[61,139],[61,63],[61,137],[61,65],[61,63],[62,66],[63,67],[64,70],[64,70],[64,66],[64,66],[64,146],[64,150],[65,71],[65,151],[65,71],[65,67],[65,147],[65,67],[66,68],[67,69],[68,72],[68,70],[68,70],[69,73],[69,71],[69,71],[70,154],[70,74],[70,74],[70,154],[71,75],[71,75],[71,155],[71,155],[72,74],[73,75],[74,159],[75,160],[76,84],[76,84],[76,78],[76,78],[76,80],[76,80],[77,81],[77,79],[77,79],[77,85],[77,85],[77,81],[78,92],[78,132],[78,92],[78,132],[79,93],[79,133],[79,133],[79,93],[80,86],[80,82],[80,86],[80,82],[81,87],[81,83],[81,83],[81,87],[82,168],[82,168],[82,165],[82,165],[83,169],[83,169],[83,166],[83,166],[84,86],[84,88],[84,92],[84,88],[84,86],[84,92],[85,93],[85,93],[85,87],[85,88],[85,88],[85,87],[86,89],[86,165],[86,165],[86,89],[87,90],[87,166],[87,90],[87,166],[88,91],[88,89],[88,91],[88,90],[89,167],[90,167],[91,94],[91,92],[91,93],[91,92],[91,93],[91,94],[92,95],[92,95],[93,96],[93,96],[94,95],[94,99],[94,99],[94,96],[94,95],[94,96],[95,132],[95,97],[95,97],[95,132],[96,133],[96,98],[96,133],[96,98],[97,99],[97,134],[97,99],[97,101],[97,101],[97,134],[98,99],[98,135],[98,102],[98,99],[98,135],[98,102],[99,100],[99,100],[100,101],[100,101],[100,102],[100,103],[100,102],[100,103],[101,124],[101,104],[101,104],[101,124],[102,125],[102,105],[102,125],[102,105],[103,104],[103,104],[103,106],[103,106],[103,105],[103,105],[104,107],[104,122],[104,122],[104,107],[105,108],[105,108],[105,123],[105,123],[106,109],[106,107],[106,109],[106,108],[106,107],[106,108],[107,118],[107,118],[107,110],[107,110],[108,111],[108,111],[108,119],[108,119],[109,110],[109,112],[109,111],[109,112],[109,110],[109,111],[110,113],[110,142],[110,140],[110,120],[110,113],[110,120],[111,121],[111,114],[111,143],[111,121],[111,141],[111,114],[112,113],[112,114],[112,115],[112,114],[112,113],[112,115],[113,116],[113,144],[113,116],[113,148],[114,117],[114,145],[114,149],[114,117],[115,116],[115,117],[115,117],[115,116],[115,156],[115,156],[116,157],[116,152],[116,152],[116,157],[117,158],[117,158],[117,153],[117,153],[118,120],[118,128],[118,120],[118,122],[118,128],[118,122],[119,129],[119,129],[119,123],[119,121],[119,121],[119,123],[120,140],[120,130],[120,130],[120,140],[121,131],[121,141],[121,131],[121,141],[122,126],[122,124],[122,124],[122,126],[123,127],[123,125],[123,125],[123,127],[124,134],[124,134],[125,135],[125,135],[126,128],[126,134],[126,128],[126,134],[127,135],[127,129],[127,135],[127,129],[128,130],[128,130],[129,131],[129,131],[130,138],[130,138],[131,139],[131,139],[132,134],[132,134],[133,135],[133,135],[136,138],[137,139],[138,140],[138,146],[138,146],[138,140],[139,147],[139,147],[139,141],[139,141],[140,144],[140,142],[140,144],[141,145],[141,145],[141,143],[144,146],[144,146],[144,148],[145,147],[145,149],[145,147],[146,150],[147,151],[148,150],[148,152],[148,152],[148,150],[149,151],[149,153],[149,151],[149,153],[150,154],[150,154],[151,155],[151,155],[152,161],[152,154],[152,161],[152,154],[153,155],[153,155],[153,162],[153,162],[154,159],[154,159],[155,160],[155,160],[156,158],[156,157],[157,161],[158,162],[159,161],[160,162],[163,181],[163,181],[163,180],[163,180],[164,181],[164,181],[164,180],[164,180],[165,170],[165,167],[165,167],[165,170],[166,167],[166,171],[166,171],[166,167],[167,172],[167,172],[168,170],[168,185],[168,170],[168,175],[169,171],[169,176],[169,171],[169,186],[170,172],[170,182],[170,172],[170,182],[171,172],[171,183],[171,183],[171,172],[172,184],[172,184],[173,177],[173,177],[174,178],[174,178],[175,177],[175,177],[176,178],[176,178],[179,180],[179,180],[180,181],[180,181],[182,185],[182,184],[183,184],[183,186]]};

//--------------------------------
//A model that I can control
//--------------------------------

var rotateMe = new ob3D([0,410,25],horus);
rotateMe.rot[0] = -90;

rQ.push(rotateMe);


//--------------------------------
//Where da sprites at!
//--------------------------------


var drawSprite = function(o){
	//offset the points by the object's position
	var p3 = o.pos;
	//TOTALLY A HACK TO GET SOME CAMERA MOVEMENT
	var p3 = getP3Offset(p3, [camera[0],camera[1],camera[2]]);
	if( p3[2] < clipNear && p3[2] > clipFar ){
		var p2 = project3Dto2D(p3);
		//Just some basic positional culling... if it's not on screen, don't render it...
		if((p2.x + (o.offset.x * p2.scale) < cx && p2.x - (o.offset.x * p2.scale) > -cx) && (p2.y + (o.offset.y * p2.scale) < cy && p2.y - (o.offset.y * p2.scale) > -cy)){
			c.save();
			c.translate(p2.x,p2.y);
			c.scale(p2.scale,p2.scale);
			c.rotate(o.rot);
			c.drawImage(o.image,o.offset.x,o.offset.y );
			c.restore();
		}
	}
}

var sprite2D3D = function(pos,path){
	if(this === window){throw 'JIM TYPE ERROR'};
	var t = this;
	this.pos = pos || [0,0,0];
	this.image = new Image();
	this.image.onload = function(){
		t.offset = {
			x:-Math.round(t.image.width/2),
			y:-Math.round(t.image.height/2)
		};
		rQ.push(t);
		//console.log(t);
	};
	this.image.src = path;
	return this;
}

sprite2D3D.prototype = {
	pos:[0,0,0],
	rot:0,
	update:function(){
		this.rot += tau/360;
		drawSprite(this);
	},
	destroy:function(){
		for(var i = 0; i < rQ.length; i += 1){
			if(rQ[i] === this){
				rQ.splice(i,1);
			}
		}
	}
};


//--------------------------------
//The basic render loop
//--------------------------------

var resize = function(){
	cx=Math.floor(w/2);
	cy=Math.floor(h/2);
	mpos[0] = 0;
	mpos[1] = 0;
	canvas.width=w;
	canvas.height=h;
	wph=w+h;
}

var update = function(){
	w=window.innerWidth;
	h=window.innerHeight;
	if(wph != w+h){resize();}
	c.fillStyle='#rgba(0,255,0,0.4)';
	c.fillRect(0,0,w,h);
	c.save();
	//c.strokeStyle = '#fff';
	c.translate(cx,cy);

	//camera[0] = mpos[0];
	//camera[1] = mpos[1];
	rotateMe.rot[1] = (-tau / 360) * mpos[0];
	rotateMe.rot[0] = (tau / 360) * (mpos[1] /2 )- 90;

	if(scroll !== 0){camera[2] += (scroll / Math.abs(scroll)) * 50; scroll = 0;}

	//depth sorting!
	rQ.sort(function(a,b) {return a.pos[2] - b.pos[2]})

	for(var i = 0; i < rQ.length; i += 1){
		rQ[i].update();
	}

	
	//console.log(rQ[0].pos[0]);
	c.restore();
	setTimeout(update,1000/60);
}

update();
</script></body>
</html>